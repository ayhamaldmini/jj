<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>استضافة بايثون — AYHAM (Ultra)</title>

  <!-- Cairo Arabic -->
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap" rel="stylesheet">

  <meta name="theme-color" content="#0b0b10">

  <style>
    :root{
      --bg-dark:#0b0b10;
      --bg-light:#f7f7f9;
      --card-dark:#14141c;
      --card-light:#ffffff;
      --muted-dark:#bdb9c6;
      --muted-light:#666;
      --accent1:#ff7a18;
      --accent2:#ff3565;
      --radius:14px;
      --glass: rgba(255,255,255,0.03);
    }
    /* Reset */
    *{box-sizing:border-box;margin:0;padding:0}
    html,body{height:100%}
    body{
      font-family:'Cairo',sans-serif;
      background:var(--bg-dark);
      color:#fff;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      overflow-x:hidden;
    }
    .container{max-width:1150px;margin:0 auto;padding:22px}
    header{display:flex;justify-content:space-between;align-items:center;gap:12px}
    .brand{display:flex;gap:14px;align-items:center}
    .logo{
      width:72px;height:72px;border-radius:14px;
      background:linear-gradient(135deg,var(--accent1),var(--accent2));
      display:grid;place-items:center;font-weight:900;color:#fff;font-size:20px;
      box-shadow:0 18px 60px rgba(255,90,60,0.12);
    }
    h1{font-size:20px}
    /* top bar */
    .topbar{display:flex;gap:10px;align-items:center}
    .clock{font-weight:700;margin-left:8px;font-size:14px;opacity:.95}
    .greeting{font-size:14px;color:var(--muted-dark)}

    /* hero */
    .hero{
      margin-top:18px;border-radius:18px;padding:28px;position:relative;overflow:hidden;
      border:1px solid rgba(255,255,255,0.03);
      background:linear-gradient(180deg, rgba(255,90,60,0.04), rgba(0,0,0,0.22));
      box-shadow:0 30px 80px rgba(0,0,0,0.6);
    }
    .title{
      font-size:40px;
      color:#ffd9a8;
      letter-spacing:.6px;
      font-weight:800;
      margin-bottom:8px;
      white-space:pre-wrap;
    }
    .subtitle{color:var(--muted-dark);font-size:15px}

    /* dynamic tips bar */
    .newsbar{
      margin-top:14px;padding:10px 14px;border-radius:12px;background:linear-gradient(90deg, rgba(255,120,60,0.06), rgba(255,40,120,0.03));
      display:flex;align-items:center;gap:10px;font-size:13px;color:var(--muted-dark);
    }
    .newsbar strong{color:#fff}

    /* layout */
    .layout{display:grid;grid-template-columns:1fr 360px;gap:20px;margin-top:20px}
    .card{background:var(--card-dark);border-radius:12px;padding:16px;border:1px solid rgba(255,255,255,0.03)}
    .features{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:12px}
    .feature{padding:12px;border-radius:10px;background:#101018;transition:transform .28s,box-shadow .28s}
    .feature:hover{transform:translateY(-6px);box-shadow:0 20px 50px rgba(0,0,0,0.6)}
    .feature h4{color:#ffdca9;margin-bottom:6px}
    .feature p{color:var(--muted-dark);font-size:13px}

    /* FAQ */
    .faq .q{cursor:pointer;padding:12px;border-radius:10px;background:#0f0f16;margin-bottom:8px;border:1px solid rgba(255,255,255,0.02)}
    .faq .q h4{margin:0;color:#ffdca9}
    .faq .a{padding:10px 14px;margin-top:8px;background:#0b0b10;border-radius:8px;color:var(--muted-dark);display:none}

    /* side panel */
    .side{display:flex;flex-direction:column;gap:12px}
    .rules{font-size:14px;color:var(--muted-dark);line-height:1.6;background:#15151b;padding:14px;border-radius:12px;border:1px solid rgba(255,255,255,0.03)}
    .rules h3{color:#ffdf9e;margin-bottom:8px}
    .warning{background:linear-gradient(90deg,#2e0b0b,#5a1d1d);color:#ffcccc;padding:12px;border-radius:8px;margin-top:8px}

    /* controls */
    .controls{display:flex;gap:8px;flex-wrap:wrap}
    .btn{padding:10px 14px;border-radius:12px;font-weight:800;text-decoration:none;color:#fff;background:linear-gradient(90deg,var(--accent1),var(--accent2));box-shadow:0 8px 30px rgba(255,80,60,0.12);cursor:pointer;border:0}
    .btn.ghost{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted-dark)}
    .small{padding:8px 10px;font-size:13px;border-radius:10px}

    /* floating action menu */
    .fab{
      position:fixed;right:18px;bottom:18px;width:56px;height:56px;border-radius:50%;display:grid;place-items:center;z-index:1000;
      background:linear-gradient(135deg,var(--accent2),var(--accent1));box-shadow:0 18px 50px rgba(0,0,0,0.6);cursor:pointer;border:0
    }
    .fab-menu{position:fixed;right:18px;bottom:86px;display:flex;flex-direction:column;gap:10px;align-items:flex-end}
    .fab-item{background:#101018;color:#fff;padding:10px 12px;border-radius:10px;border:1px solid rgba(255,255,255,0.03);box-shadow:0 8px 30px rgba(0,0,0,0.4);cursor:pointer}

    /* background controls */
    .bg-controls{display:flex;gap:8px;flex-wrap:wrap;align-items:center}

    /* reading mode */
    .reading-mode { position:fixed; left:18px; bottom:18px; z-index:1000; background:#111; padding:8px 10px; border-radius:10px; border:1px solid rgba(255,255,255,0.04); cursor:pointer }

    /* spinner splash */
    #splash{position:fixed;inset:0;background:var(--bg-dark);display:grid;place-items:center;z-index:2000}
    .splash-card{width:160px;height:160px;border-radius:18px;background:linear-gradient(135deg,var(--accent1),var(--accent2));display:grid;place-items:center;color:#fff;font-weight:900;font-size:36px;box-shadow:0 30px 90px rgba(0,0,0,0.6);transform-style:preserve-3d}
    .spinner3d{animation:spin3d 1600ms linear infinite}
    @keyframes spin3d{0%{transform:rotateX(0) rotateY(0) rotateZ(0)}100%{transform:rotateX(360deg) rotateY(360deg) rotateZ(0)}}

    /* animated gradient buttons */
    .btn-glow{background:linear-gradient(90deg,var(--accent1),var(--accent2));background-size:200% 200%;animation:glow 6s linear infinite}
    @keyframes glow{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}

    /* typing effect */
    .typing{display:inline-block;border-right:2px solid rgba(255,255,255,0.12);padding-right:6px}

    /* parallax layers */
    #bg-canvas{position:fixed;inset:0;z-index:-1;pointer-events:none}

    /* responsive */
    @media (max-width:1000px){
      .layout{grid-template-columns:1fr}
      .logo{width:56px;height:56px}
      .title{font-size:28px}
    }

    /* scroll reveal initial */
    .reveal{opacity:0;transform:translateY(14px);transition:all .7s cubic-bezier(.2,.9,.3,1)}
    .reveal.show{opacity:1;transform:none}
  </style>
</head>
<body>

  <!-- Animated favicon canvas (hidden) -->
  <canvas id="favicon-canvas" width="64" height="64" style="display:none"></canvas>

  <!-- Background interactive canvas -->
  <canvas id="bg-canvas"></canvas>

  <!-- Splash screen -->
  <div id="splash">
    <div class="splash-card spinner3d">PY</div>
  </div>

  <div class="container" id="page">
    <header>
      <div class="brand">
        <div class="logo" id="logoElm">PY</div>
        <div>
          <h1>استضافة بايثون</h1>
          <div style="font-size:13px;color:var(--muted-dark)">واجهة متطورة لرفع وتشغيل ملفات البايثون</div>
        </div>
      </div>

      <div class="topbar">
        <div class="greeting" id="greet">👋 أهلاً بك، <strong id="u-name">زائر</strong></div>
        <div class="clock" id="liveClock">--:--:--</div>
        <button class="small btn ghost" id="themeToggle" title="تبديل الوضع">الـوضع</button>
      </div>
    </header>

    <main>
      <section class="hero reveal" id="hero">
        <div class="title" id="typedTitle"></div>
        <div class="subtitle">ادِر بوتك بسهولة: رفع ملفات، تثبيت مكتبات، كشف الأخطاء، وإدارة التشغيل — مع احترام القوانين.</div>

        <div class="newsbar" id="newsbar">
          <div id="newsIcon">💡</div>
          <div id="newsText"><strong>نصيحة:</strong> تذكّر مراجعة التوكن والتأكد من خلوه من webhooks.</div>
        </div>
      </section>

      <div class="layout">
        <div class="left">
          <div class="card reveal" id="featuresCard">
            <h3 style="color:#ffdca9;margin-bottom:12px">مزايا البوت</h3>
            <div class="features">
              <div class="feature">
                <h4>📂 رفع ملفات بسهولة</h4><p>دعم ملفات <code>.py</code> مع تحقّق مبدئي وحماية.</p>
              </div>
              <div class="feature">
                <h4>🔍 كاشف أخطاء ذكي</h4><p>تحليل الأخطاء الشائعة وتقديم اقتراحات تصحيح.</p>
              </div>
              <div class="feature">
                <h4>📚 تثبيت تلقائي</h4><p>قراءة <code>requirements.txt</code> وتثبيت الحزم تلقائياً.</p>
              </div>
              <div class="feature">
                <h4>⏸️ تشغيل/إيقاف مرن</h4><p>إدارة تشغيل الملفات والتحكم في الجلسات.</p>
              </div>
            </div>
          </div>

          <div class="card reveal" style="margin-top:12px" id="loginCard">
            <h3 style="color:#ffdca9;margin-bottom:8px">تسجيل الدخول عبر Telegram</h3>
            <p style="color:var(--muted-dark);margin-bottom:12px">اضغط زر الدخول عبر تليجرام لعرض اسمك وصورتك.</p>

            <!-- Telegram widget -->
            <div id="tg-wrapper" style="display:flex;gap:12px;align-items:center;flex-wrap:wrap">
              <script async src="https://telegram.org/js/telegram-widget.js?22"
                      data-telegram-login="host_ayham_bot"
                      data-size="large"
                      data-userpic="true"
                      data-request-access="write"
                      data-onauth="onTelegramAuth">
              </script>
              <div>
                <button class="btn ghost" id="enableVoice">🔊 صوت الترحيب</button>
                <button class="btn ghost" id="disableVoice" style="display:none">🔇 إيقاف الصوت</button>
              </div>
            </div>
          </div>

          <div class="card reveal" style="margin-top:12px" id="faqCard">
            <h3 style="color:#ffdca9;margin-bottom:8px">الأسئلة الشائعة</h3>
            <div class="faq">
              <div class="q" data-id="q1"><h4>كيف أرفع ملف؟</h4></div>
              <div class="a" id="a-q1">استخدم بوت الاستضافة عبر رابط "ابدأ الآن" ثم اتبع التعليمات لرفع الملف بصيغة .py.</div>

              <div class="q" data-id="q2"><h4>هل يمكن رفع ملفات مشفرة؟</h4></div>
              <div class="a" id="a-q2">لا — رفع الملفات المشفرة محظور وفق القواعد الموضحة أدناه.</div>

              <div class="q" data-id="q3"><h4>ماذا عن التوكن؟</h4></div>
              <div class="a" id="a-q3">تأكد أن التوكن صالح وخالٍ من webhooks، وأنه مُستخدَم بطريقة آمنة.</div>
            </div>
          </div>
        </div>

        <aside class="side reveal" id="sidePanel">
          <div class="rules">
            <h3>📌 متطلبات رفع الملفات</h3>
            <ul>
              <li>✅ يدعم ملفات Python فقط (.py)</li>
              <li>✅ تأكد من وجود توكن البوت داخل الملف (إن لزم)</li>
              <li>✅ تأكد من خلو التوكن من webhook</li>
              <li>✅ تأكد من سلامة الكود وعدم وجود تعليمات ضارة</li>
            </ul>

            <h3 style="margin-top:8px">⚠️ الممنوعات والقيود</h3>
            <ol>
              <li>🚫 أنظمة تخزين (قواعد بيانات/حفظ ملفات)</li>
              <li>🚫 بوتات تشغيل أكواد خارجية أو سكربتات تحكم</li>
              <li>🚫 رفع ملفات مشفّرة أو مشفرة</li>
              <li>🚫 محاولات اختراق أو استغلال ثغرات</li>
              <li>🚫 أكواد ضارة (فيروسات/تعديل غير مصرح به)</li>
            </ol>

            <div class="warning">
              ⚠️ تحذير مهم<br>أي مخالفة تعني: 🔴 حظر فوري — 🔴 لا رجعة في الحظر
            </div>

            <div style="margin-top:10px;display:flex;gap:8px;flex-wrap:wrap">
              <div class="bg-controls">
                <button class="small btn ghost" data-bg="stars">✨ نجوم</button>
                <button class="small btn ghost" data-bg="waves">🌊 أمواج</button>
                <button class="small btn ghost" data-bg="grid">💠 شبكة</button>
                <button class="small btn ghost" data-bg="gradient">🎨 تدرج</button>
              </div>
            </div>
          </div>

          <div style="display:flex;flex-direction:column;gap:10px;margin-top:10px">
            <a class="btn btn-glow" id="startBtn" href="https://t.me/host_ayham_bot" target="_blank">🚀 ابدأ الآن</a>
            <a class="btn ghost" id="contactBtn" href="https://t.me/fnffo" target="_blank">📩 تواصل معنا</a>
          </div>
        </aside>
      </div>

    </main>

    <footer style="margin-top:20px;text-align:center;color:var(--muted-dark);font-size:13px">
      <div id="dateTime">--</div>
      © 2025 AYHAM — جميع الحقوق محفوظة
    </footer>
  </div>

  <!-- Floating controls -->
  <div class="fab" id="fab">≡</div>
  <div class="fab-menu" id="fabMenu" style="display:none">
    <div class="fab-item" data-action="top">🔝 العودة للأعلى</div>
    <div class="fab-item" data-action="rules">📜 القوانين</div>
    <div class="fab-item" data-action="contact">✉️ تواصل</div>
  </div>

  <div class="reading-mode" id="readingBtn" title="وضع القراءة">📖</div>

  <!-- Optional audio for welcome -->
  <audio id="welcomeAudio" preload="auto">
    <source src="" type="audio/mp3">
  </audio>

  <!-- Scripts -->
  <script>
    /***********************
     CONFIG (يمكن تعديلها)
    ************************/
    const CONFIG = {
      splashDuration: 1600,
      enableVoiceByDefault: false,
      enableVibrationOnStart: true,
      dynamicTips: [
        "💡 تذكر مراجعة الكود قبل الرفع.",
        "⚠️ أي مخالفة تعني حظر فوري.",
        "🔒 تأكد من سرية التوكن وعدم نشره.",
        "📂 ارفع ملفات .py فقط.",
        "🚀 استخدم زر 'ابدأ الآن' لفتح بوت الرفع."
      ],
      bgTypes: ["stars","waves","grid","gradient"],
    };

    /***********************
     Utilities & STATE
    ************************/
    const STATE = {
      user: null,
      bgType: localStorage.getItem('ayham_bg') || 'stars',
      theme: localStorage.getItem('ayham_theme') || 'dark',
      tipIndex: 0
    };

    /***********************
     Splash & Init
    ************************/
    document.addEventListener('DOMContentLoaded',()=>{
      // typing effect for title
      startTyping();

      // fade out splash after configured duration
      setTimeout(()=> {
        document.getElementById('splash').style.opacity = 0;
        document.getElementById('splash').style.pointerEvents = 'none';
        setTimeout(()=>document.getElementById('splash').remove(),400);
      }, CONFIG.splashDuration);

      // set theme
      applyTheme(STATE.theme);

      // Init bg canvas
      initBGCanvas(STATE.bgType);

      // show initial reveal (scroll)
      revealOnScroll();

      // start clock
      startClock();

      // dynamic tips
      startTips();

      // set up fab
      setupFab();

      // reading mode
      setupReadingMode();

      // FAQ accordion
      setupFAQ();

      // background switch buttons
      document.querySelectorAll('[data-bg]').forEach(btn=>{
        btn.addEventListener('click', () => {
          const t = btn.getAttribute('data-bg');
          STATE.bgType = t;
          localStorage.setItem('ayham_bg', t);
          initBGCanvas(t);
        });
      });

      // theme toggle
      document.getElementById('themeToggle').addEventListener('click',()=>{
        STATE.theme = (STATE.theme === 'dark') ? 'light' : 'dark';
        localStorage.setItem('ayham_theme', STATE.theme);
        applyTheme(STATE.theme);
      });

      // enable/disable voice
      const enableVoice = document.getElementById('enableVoice');
      const disableVoice = document.getElementById('disableVoice');
      enableVoice.addEventListener('click',()=>{
        localStorage.setItem('ayham_voice','1');
        enableVoice.style.display='none';
        disableVoice.style.display='inline-block';
      });
      disableVoice.addEventListener('click',()=>{
        localStorage.removeItem('ayham_voice');
        disableVoice.style.display='none';
        enableVoice.style.display='inline-block';
      });
      if(localStorage.getItem('ayham_voice')) {
        enableVoice.style.display='none';
        disableVoice.style.display='inline-block';
      }

      // reading mode toggle
      document.getElementById('readingBtn').addEventListener('click', toggleReadingMode);

      // startBtn vibration
      document.getElementById('startBtn').addEventListener('click', ()=>{
        if(CONFIG.enableVibrationOnStart && navigator.vibrate) navigator.vibrate(60);
      });

      // animate reveal on scroll
      window.addEventListener('scroll', revealOnScroll);
      window.addEventListener('load', revealOnScroll);

      // fab interactions
      document.getElementById('fab').addEventListener('click', toggleFabMenu);
      document.querySelectorAll('.fab-item').forEach(it=>{
        it.addEventListener('click', (e)=>{
          const a = it.getAttribute('data-action');
          if(a==='top') window.scrollTo({top:0,behavior:'smooth'});
          if(a==='rules') document.querySelector('.rules').scrollIntoView({behavior:'smooth'});
          if(a==='contact') document.getElementById('contactBtn').click();
        });
      });

      // animated favicon
      startFaviconAnimation();

    }); // DOMContentLoaded end

    /***********************
     Typing Effect (title)
    ************************/
    const TITLE_TEXT = "الصفحة الملكية — استضافة بوت بايثون";
    function startTyping(){
      const el = document.getElementById('typedTitle');
      let i=0;
      function step(){
        el.innerHTML = '<span class="typing">' + TITLE_TEXT.slice(0,i) + '</span>';
        i++;
        if(i<=TITLE_TEXT.length) setTimeout(step, 35);
        else el.innerHTML = TITLE_TEXT; // end
        // reveal hero after typing start
        setTimeout(()=> document.getElementById('hero').classList.add('show'), 100);
      }
      step();
    }

    /***********************
     Reveal on scroll
    ************************/
    function revealOnScroll(){
      document.querySelectorAll('.reveal').forEach(el=>{
        const rect = el.getBoundingClientRect();
        if(rect.top < window.innerHeight - 80) el.classList.add('show');
      });
    }

    /***********************
     Theme handling
    ************************/
    function applyTheme(t){
      if(t==='light'){
        document.documentElement.style.setProperty('--bg-dark', '#f7f7f9');
        document.documentElement.style.setProperty('--card-dark', '#ffffff');
        document.documentElement.style.setProperty('--muted-dark', '#666');
        document.body.style.background = 'var(--bg-dark)';
        document.body.style.color = '#111';
        document.querySelectorAll('.card').forEach(c=>c.style.background='#fff');
        document.querySelectorAll('.feature').forEach(f=>f.style.background='#fbfbff');
        document.querySelectorAll('.rules').forEach(r=>r.style.background='#fff');
        document.querySelectorAll('.btn').forEach(b=>b.style.boxShadow='0 6px 18px rgba(0,0,0,0.08)');
        document.getElementById('logoElm').style.boxShadow='0 8px 30px rgba(0,0,0,0.06)';
        document.getElementById('logoElm').style.color='#fff';
        document.querySelector('meta[name="theme-color"]').setAttribute('content','#f7f7f9');
      } else {
        // dark
        document.documentElement.style.setProperty('--bg-dark', '#0b0b10');
        document.documentElement.style.setProperty('--card-dark', '#14141c');
        document.documentElement.style.setProperty('--muted-dark', '#bdb9c6');
        document.body.style.background = 'var(--bg-dark)';
        document.body.style.color = '#fff';
        document.querySelectorAll('.card').forEach(c=>c.style.background='var(--card-dark)');
        document.querySelectorAll('.feature').forEach(f=>f.style.background='#101018');
        document.querySelectorAll('.rules').forEach(r=>r.style.background='#15151b');
        document.querySelectorAll('.btn').forEach(b=>b.style.boxShadow='0 8px 30px rgba(255,80,60,0.12)');
        document.getElementById('logoElm').style.boxShadow='0 18px 60px rgba(255,90,60,0.12)';
        document.querySelector('meta[name="theme-color"]').setAttribute('content','#0b0b10');
      }
    }

    /***********************
     Clock & Greeting
    ************************/
    function startClock(){
      const clk = document.getElementById('liveClock');
      const dateEl = document.getElementById('dateTime');
      function tick(){
        const d = new Date();
        const hh = String(d.getHours()).padStart(2,'0');
        const mm = String(d.getMinutes()).padStart(2,'0');
        const ss = String(d.getSeconds()).padStart(2,'0');
        clk.textContent = hh+':'+mm+':'+ss;
        dateEl.textContent = d.toLocaleString();
        // dynamic greeting based on hour (if no user)
        const name = (STATE.user && (STATE.user.first_name || STATE.user.username)) ? (STATE.user.first_name || STATE.user.username) : 'زائر';
        let greet = 'أهلاً بعودتك';
        if(d.getHours() < 12) greet = 'صباح الخير';
        else if(d.getHours() < 18) greet = 'مساء الخير';
        else greet = 'مساء الخير';
        document.getElementById('greet').innerHTML = `${greet}، <strong id="u-name">${name}</strong>`;
      }
      tick(); setInterval(tick,1000);
    }

    /***********************
     Dynamic Tips (news bar)
    ************************/
    function startTips(){
      const el = document.getElementById('newsText');
      setInterval(()=>{
        STATE.tipIndex = (STATE.tipIndex + 1) % CONFIG.dynamicTips.length;
        el.innerHTML = `<strong>معلومة:</strong> ${CONFIG.dynamicTips[STATE.tipIndex]}`;
      },10000);
    }

    /***********************
     FAB menu
    ************************/
    function toggleFabMenu(){
      const menu = document.getElementById('fabMenu');
      if(menu.style.display==='none' || menu.style.display==='') menu.style.display='flex';
      else menu.style.display='none';
    }
    function setupFab(){
      // hide on scroll down (optional)
      let lastY = window.scrollY;
      window.addEventListener('scroll', ()=> {
        const fab = document.getElementById('fab');
        if(window.scrollY > lastY + 10) fab.style.transform='scale(.92)';
        else fab.style.transform='scale(1)';
        lastY = window.scrollY;
      });
    }

    /***********************
     Reading Mode toggle
    ************************/
    function toggleReadingMode(){
      const body = document.body;
      if(body.classList.contains('reading')){
        body.classList.remove('reading');
        document.getElementById('readingBtn').textContent='📖';
      } else {
        body.classList.add('reading');
        document.getElementById('readingBtn').textContent='✖️';
      }
      // reading mode styles (simple)
      if(body.classList.contains('reading')){
        document.querySelectorAll('.hero, .card, .rules, .faq, .feature').forEach(el=>{
          el.style.background='#efefef'; el.style.color='#111';
        });
        document.body.style.background='#e9e9e9';
      } else {
        // revert by re-applying theme
        applyTheme(STATE.theme);
      }
    }
    function setupReadingMode(){
      const btn = document.getElementById('readingBtn');
      // double-click to toggle
      btn.addEventListener('dblclick', toggleReadingMode);
    }

    /***********************
     FAQ accordion
    ************************/
    function setupFAQ(){
      document.querySelectorAll('.faq .q').forEach(q=>{
        q.addEventListener('click', ()=>{
          const a = q.nextElementSibling;
          const visible = a.style.display === 'block';
          document.querySelectorAll('.faq .a').forEach(x=>x.style.display='none');
          if(!visible) a.style.display='block';
        });
      });
    }

    /***********************
     Background canvas (particles / waves / grid / gradient)
    ************************/
    let bgCtx, bgCanvas, bgAnimId;
    function initBGCanvas(type='stars'){
      const canvas = document.getElementById('bg-canvas');
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
      bgCtx = canvas.getContext('2d');
      if(bgAnimId) cancelAnimationFrame(bgAnimId);
      if(type==='stars') startStars(canvas,bgCtx);
      else if(type==='waves') startWaves(canvas,bgCtx);
      else if(type==='grid') startGrid(canvas,bgCtx);
      else startGradient(canvas,bgCtx);
    }

    // simple stars
    function startStars(canvas,ctx){
      const stars = Array.from({length:120}, ()=>{
        return {x:Math.random()*canvas.width,y:Math.random()*canvas.height,r:Math.random()*1.6,dx:(Math.random()-0.5)*0.2,dy:(Math.random()-0.5)*0.2,alpha:Math.random()};
      });
      function loop(){
        ctx.clearRect(0,0,canvas.width,canvas.height);
        for(const s of stars){
          s.x += s.dx; s.y += s.dy;
          if(s.x<0) s.x=canvas.width; if(s.x>canvas.width) s.x=0;
          if(s.y<0) s.y=canvas.height; if(s.y>canvas.height) s.y=0;
          ctx.beginPath();
          ctx.fillStyle = 'rgba(255,255,255,'+(0.2 + 0.8*s.alpha)+')';
          ctx.arc(s.x,s.y,s.r,0,Math.PI*2);
          ctx.fill();
        }
        bgAnimId = requestAnimationFrame(loop);
      }
      loop();
    }

    // waves
    function startWaves(canvas,ctx){
      let t = 0;
      function loop(){
        ctx.clearRect(0,0,canvas.width,canvas.height);
        const grad = ctx.createLinearGradient(0,0,canvas.width,canvas.height);
        grad.addColorStop(0,'rgba(255,40,120,0.04)');
        grad.addColorStop(1,'rgba(255,120,60,0.02)');
        ctx.fillStyle = grad; ctx.fillRect(0,0,canvas.width,canvas.height);
        ctx.beginPath();
        for(let x=0;x<canvas.width;x+=8){
          const y = canvas.height/2 + Math.sin((x/80)+t)*40 + Math.cos((x/120)+t*0.7)*24;
          ctx.lineTo(x,y);
        }
        ctx.lineTo(canvas.width,canvas.height); ctx.lineTo(0,canvas.height); ctx.closePath();
        ctx.fillStyle='rgba(20,20,30,0.6)'; ctx.fill();
        t += 0.01;
        bgAnimId = requestAnimationFrame(loop);
      }
      loop();
    }

    // grid
    function startGrid(canvas,ctx){
      function loop(){
        ctx.clearRect(0,0,canvas.width,canvas.height);
        ctx.fillStyle = 'rgba(10,10,14,0.7)'; ctx.fillRect(0,0,canvas.width,canvas.height);
        ctx.strokeStyle='rgba(255,255,255,0.02)'; ctx.lineWidth=1;
        const gap = 60;
        for(let x=0;x<canvas.width;x+=gap){
          ctx.beginPath(); ctx.moveTo(x,0); ctx.lineTo(x,canvas.height); ctx.stroke();
        }
        for(let y=0;y<canvas.height;y+=gap){
          ctx.beginPath(); ctx.moveTo(0,y); ctx.lineTo(canvas.width,y); ctx.stroke();
        }
        bgAnimId = requestAnimationFrame(loop);
      }
      loop();
    }

    // gradient
    function startGradient(canvas,ctx){
      let a=0;
      function loop(){
        const g = ctx.createLinearGradient(0,0,canvas.width,canvas.height);
        g.addColorStop(0, `hsl(${Math.floor(200 + 50*Math.sin(a))},70%,8%)`);
        g.addColorStop(1, `hsl(${Math.floor(320 + 50*Math.cos(a))},70%,12%)`);
        ctx.fillStyle = g; ctx.fillRect(0,0,canvas.width,canvas.height);
        a += 0.002;
        bgAnimId = requestAnimationFrame(loop);
      }
      loop();
    }

    window.addEventListener('resize', ()=> {
      const c = document.getElementById('bg-canvas');
      c.width = window.innerWidth; c.height = window.innerHeight;
      initBGCanvas(STATE.bgType);
    });

    /***********************
     Animated favicon (simple changing circle)
    ************************/
    function startFaviconAnimation(){
      const canvas = document.getElementById('favicon-canvas');
      const ctx = canvas.getContext('2d');
      let a=0;
      function loop(){
        ctx.clearRect(0,0,64,64);
        // background
        ctx.fillStyle = '#111';
        ctx.fillRect(0,0,64,64);
        // rotating gradient circle
        const grad = ctx.createLinearGradient(0,0,64,64);
        grad.addColorStop(0, 'rgb(255,122,34)');
        grad.addColorStop(1, 'rgb(255,53,101)');
        ctx.fillStyle = grad;
        ctx.save();
        ctx.translate(32,32);
        ctx.rotate(a);
        ctx.beginPath(); ctx.arc(0,0,18,0,Math.PI*2); ctx.fill();
        ctx.restore();
        const link = document.querySelector("link[rel~='icon']") || document.createElement('link');
        link.rel = 'icon';
        link.href = canvas.toDataURL('image/png');
        if(!document.querySelector("link[rel~='icon']")) document.head.appendChild(link);
        a += 0.04;
        requestAnimationFrame(loop);
      }
      loop();
    }

    /***********************
     Telegram Login callback
    ************************/
    function onTelegramAuth(user){
      // user: id, first_name, last_name?, username?, photo_url?, auth_date, hash
      STATE.user = user;
      const display = ((user.first_name||'') + ' ' + (user.last_name||'')).trim() || user.username || 'مستخدم';
      document.getElementById('u-name').textContent = display;
      if(user.photo_url){
        const avatar = document.getElementById('logoElm');
        avatar.innerHTML = '';
        const img = document.createElement('img');
        img.src = user.photo_url;
        img.alt = display;
        img.style.width='100%'; img.style.height='100%'; img.style.objectFit='cover'; img.style.borderRadius='12px';
        avatar.appendChild(img);
      }
      // voice greeting if enabled
      if(localStorage.getItem('ayham_voice') || CONFIG.enableVoiceByDefault){
        playWelcomeVoice(display);
        document.getElementById('enableVoice').style.display='none';
        document.getElementById('disableVoice').style.display='inline-block';
      }
      // small toast suppressed by request — instead show flashing start button
      pulseStartButton();
    }

    /***********************
     Play welcome voice (simple speechSynthesis)
    ************************/
    function playWelcomeVoice(name){
      try{
        if('speechSynthesis' in window){
          const msg = new SpeechSynthesisUtterance(`أهلاً ${name}، مرحباً بك في استضافة بايثون`);
          msg.lang = 'ar-SA';
          window.speechSynthesis.cancel();
          window.speechSynthesis.speak(msg);
        }
      }catch(e){console.warn('TTS not supported',e)}
    }

    /***********************
     Pulse start button to attract attention
    ************************/
    function pulseStartButton(){
      const btn = document.getElementById('startBtn');
      btn.animate([
        { boxShadow: '0 8px 30px rgba(255,80,60,0.12)', transform:'scale(1)' },
        { boxShadow: '0 18px 70px rgba(255,80,60,0.28)', transform:'scale(1.03)' },
        { boxShadow: '0 8px 30px rgba(255,80,60,0.12)', transform:'scale(1)' }
      ], { duration: 2000, iterations: 3 });
    }

    /***********************
     Reveal on initial load (small delay)
    ************************/
    setTimeout(()=> {
      document.querySelectorAll('.reveal').forEach((el,i)=> setTimeout(()=> el.classList.add('show'), 120*i));
    }, 800);
  </script>

  <!-- Telegram widget loader (calls onTelegramAuth on success) -->
  <!-- Note: you must add your site domain to BotFather settings for the widget to return data -->
  <script async src="https://telegram.org/js/telegram-widget.js?22" data-telegram-login="host_ayham_bot" data-size="large" data-userpic="true" data-request-access="write" data-onauth="onTelegramAuth"></script>

</body>
</html>